# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"
1. На лекции мы обсудили, что манипулировать размером окна необходимо для эффективного наполнения приемного буфера участников TCP сессии (Flow Control). Подобная проблема в полной мере возникает в сетях с высоким RTT. Например, если вы захотите передать 500 Гб бэкап из региона Юга-Восточной Азии на Восточное побережье США. Здесь вы можете увидеть и 200 и 400 мс вполне реального RTT. Подсчитайте, какого размера нужно окно TCP чтобы наполнить 1 Гбит/с канал при 300 мс RTT (берем простую ситуацию без потери пакетов). Можно воспользоваться готовым калькулятором. Ознакомиться с формулами, по которым работает калькулятор можно, например, на Wiki.

Ответ:
```
37500kbyte
по формуле получается что rwin = rtt*throughput = 300*1Гбит/с = 37500000/8 = 36622kbyte 
[8 - потому что размер окна в байтах а скорость в битах]
```

2. Во сколько раз упадет пропускная способность канала, если будет 1% потерь пакетов при передаче?

Ответ:
Уравнение Mathis
Существует три основных показателя, которые влияют на пропускную способность соединения TCP: время прохождения сигнала в обоих направлениях ( RTT ), потеря пакетов ( p ) и максимальный размер сегмента ( MSS ). Хорошей моделью, которая описывает взаимосвязь этих трех переменных пропускной способности, является уравнение Mathis. Уравнение Mathis утверждает, что максимальная пропускная способность, достигаемая соединением TCP, может быть рассчитана путем деления MSS на RTT и умножения результата на 1 по квадратному корню из p , где p представляет потерю пакета.
-> пересчитал на калькуляторе - примерно в 1000 раз.



3. Падение скорости зависит и от патери пакетов и от заедржек передачи (как считали в 1м номере)
Какая максимальная реальная скорость передачи данных достижима при линке 100 Мбит/с? Вопрос про TCP payload, то есть цифры, которые вы реально увидите в операционной системе в тестах или в браузере при скачивании файлов. Повлияет ли размер фрейма на это?

Ответ:
Если брать за реальные данные содержимое пакета (application data) без заголовков
а именно, пакет = 14 + MTU +4 = {64 - 1518}
в MTU входят еще TCP и IP пакеты по 20 байт
Итого службной информации = 14+4+20+20=58 байт 
```
             min    max
      общая  64     1518 
   полезная  6      1460
  служебная  58     58
 % полезной  9,37%  96,18%
```
 
размер Фрейма влияет прямопропорционально, так как его размер  влияет на долю служебных данных в пакетах.

4. Что на самом деле происходит, когда вы открываете сайт? :) На прошлой лекции был приведен сокращенный вариант ответа на этот вопрос. Теперь вы знаете намного больше, в частности про IP адресацию, DNS и т.д. Опишите максимально подробно насколько вы это можете сделать, что происходит, когда вы делаете запрос curl -I http://netology.ru с вашей рабочей станции. Предположим, что arp кеш очищен, в локальном DNS нет закешированных записей.

Ответ:
```
1. Получение IP по имени 
   2.0 поиск в локальном КЭШ соответсвия имени хоста (а нету) 
   2.1 Запрос на клиентский ДНС (ДНС провайдера), далее если нету рекурсивные запросы:
   2.2 Запрос на корневой ДНС . -> редирект на ru.
   2.3 Запрос на ru -> редрект на netology
   2.4 запрос на netology -> возврат IP
3. Запрос/установка соединения к хосту по порту 80 (SYN)
4. Открытие/подтверждение соединения SYN, ACK
5. Запрос URL у сервера ACK + HTTP запрос 
6. Возврат ответа (в нашем случае только заголовки) ACK + HTTP HEAD
7. Подтверждение получения ACK
7. Запрос на закрытие саодинения FIN
8. Подтверждение закрытия FIN
9. Подтверждение закрытия 
```
5. Сколько и каких итеративных запросов будет сделано при резолве домена www.google.co.uk?

Ответ:
Если считать, что и у нас, и в клиентском ДНС нет информации - то 5 запросов
```
1. Запрос к клиентскому ДНС  -> перенаправит на корневой DNS сервер
2. корневой ДНС              -> перенаправит на зону UK
3. ДНС зоны uk               -> перенаправит на зону CO.UK
4. ДНС зоны co.uk            -> перенаправит на google.co.uk
5. ДНС зоны google.co.uk     -> вернет IP адрес, клиентскому ДНС который вернет его клиенту
```
6. Сколько доступно для назначения хостам адресов в подсети /25? А в подсети с маской 255.248.0.0. Постарайтесь потренироваться в ручных вычислениях чтобы немного набить руку, не пользоваться калькулятором сразу.

Ответ:
 Маска /25 - 126 хостов (7 бит -> 2:7 = 128, - 2 служебных адреса 0 и 255)
 Маска 255.248.0.0 - 524286 (248 = -3 бита, 2 октета - 16 бит, 16+3 = 19 бит, 2^19=524288, -2 зарезервированных служебных адреса)

17. В какой подсети больше адресов, в /23 или /24?

Ответ:
В подсети с меньшим номером хостов больше => /23 >/24
> на 1 бит => больше в двое (без учета занятости служебных адрестов 0 и 255)

8. Получится ли разделить диапазон 10.0.0.0/8 на 128 подсетей по 131070 адресов в каждой? Какая маска будет у таких подсетей?

Ответ:
Да (10.0.0.0/8 это маска в 24 бита = 2^24 = 16777216 адресов (в т.ч. 2 служебных)
     128*131070 + 256 = 16777216 [256 - число занятых служебных адресов в 128 подсетях])

128 подсетей = 2^7, +7 бит маски, 8+7=15, маска новых подсетей будет = /15.
